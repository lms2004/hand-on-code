import numpy as np

# ğŸ² æ„é€ æ•°æ®ï¼šy = 2x + 1 åŠ å™ªå£°ï¼ˆæ¨¡æ‹ŸçœŸå®åœºæ™¯ï¼‰
np.random.seed(0)
X = np.linspace(0, 10, 100)                     # 100 ä¸ªè¾“å…¥æ ·æœ¬
Y = 2 * X + 1 + np.random.randn(*X.shape) * 1.5 # åŠ å™ªå£°çš„çº¿æ€§å‡½æ•°

# åˆå§‹åŒ–å‚æ•°
w = 0.0  # åˆå§‹æ–œç‡
b = 0.0  # åˆå§‹åç½®
lr = 0.01  # å­¦ä¹ ç‡ï¼ˆæ­¥é•¿ï¼‰
epochs = 1000  # è¿­ä»£æ¬¡æ•°
m = len(X)  # æ ·æœ¬æ•°

# ğŸ” æ¢¯åº¦ä¸‹é™
for epoch in range(epochs):
    # 1ï¸âƒ£ é¢„æµ‹å€¼ï¼šÅ· = wx + b
    Y_pred = w * X + b

    # 2ï¸âƒ£ è¯¯å·®é¡¹ï¼šerror = Å· - y
    error = Y_pred - Y

    # 3ï¸âƒ£ è®¡ç®—æ¢¯åº¦
    # ğŸ¯ æŸå¤±å‡½æ•° J(w,b) = (1/2m) * Î£(wx + b - y)^2
    # ğŸ§  å¯¹ w æ±‚åå¯¼ï¼šâˆ‚J/âˆ‚w = (1/m) * Î£(error * x)
    dw = (1/m) * np.dot(error, X)

    # ğŸ§  å¯¹ b æ±‚åå¯¼ï¼šâˆ‚J/âˆ‚b = (1/m) * Î£(error)
    db = (1/m) * np.sum(error)

    # 4ï¸âƒ£ æ›´æ–°å‚æ•°ï¼ˆæ¢¯åº¦ä¸‹é™å…¬å¼ï¼‰
    # w = w - Î± * âˆ‚J/âˆ‚w
    # b = b - Î± * âˆ‚J/âˆ‚b
    w -= lr * dw
    b -= lr * db

    # 5ï¸âƒ£ è®¡ç®—å½“å‰æŸå¤±ï¼Œç”¨äºè§‚å¯Ÿæ”¶æ•›
    # ğŸ¯ Loss = (1/2m) * Î£(Å· - y)^2
    loss = (1/(2*m)) * np.sum(error**2)

    if epoch % 10 == 0:
        print(f"Epoch {epoch:03d}: Loss={loss:.4f}, w={w:.4f}, b={b:.4f}")
